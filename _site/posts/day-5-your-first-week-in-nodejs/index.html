<!doctype html><html lang="en"><head><meta charset="utf-8"><link rel="shortcut icon" href="/assets/favicons/favicon.ico"><link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/assets/favicons/android-chrome-192x192.png" sizes="192x192"><link rel="icon" type="image/png" href="/assets/favicons/android-chrome-512x512.png" sizes="512x512"><link rel="apple-touch-icon" href="/assets/favicons/apple-touch-icon.png"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><meta name="msapplication-TileColor" content="#F9FAFB"><meta name="theme-color" content="#F9FAFB"><title>Learn with Gurpreet - Day 5 - Your first week in NodeJS</title><meta name="keywords" content="expressjs tutorial, expressjs template engine tutorial, how to create express server, backend nodejs tutorial, best node js tutorial for beginners, best nodejs tutorial, best practices node js tutorial, buffer node js tutorial, tutorial node js, tutorial node.js, was ist node.js, what is node js tutorial, what is node js with example, why node.js, nodejs basics, basic understanding of nodejs, start with nodejs"><meta name="description" content="I explained how to implement a template engine to get dynamic variables into your HTML file."><meta name="og:image" content="https://learnwithgurpreet.com/assets/images/nodejs-day5.webp"><meta name="og:title" content="Learn with Gurpreet - Day 5 - Your first week in NodeJS"><meta name="og:description" content="I explained how to implement a template engine to get dynamic variables into your HTML file."><meta name="og:url" content="https://learnwithgurpreet.com/posts/day-5-your-first-week-in-nodejs/"><meta name="og:site_name" content="Learn with Gurpreet"><meta name="og:locale" content="en_GB"><meta name="og:type" content="article"><meta name="twitter:title" content="Learn with Gurpreet - Day 5 - Your first week in NodeJS"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="I explained how to implement a template engine to get dynamic variables into your HTML file."><meta name="twitter:image" content="https://learnwithgurpreet.com/assets/images/nodejs-day5.webp"><meta name="generator" content="Eleventy v2.0.1"><meta itemprop="name" content="Learn with Gurpreet - Day 5 - Your first week in NodeJS"><meta itemprop="description" content="I explained how to implement a template engine to get dynamic variables into your HTML file."><link rel="stylesheet" href="/assets/css/styles.css?v=1681830158611"><link rel="alternate" href="https://learnwithgurpreet.com/feed/feed.xml" type="application/atom+xml" title="gS"><link rel="alternate" href="https://learnwithgurpreet.com/feed/feed.json" type="application/json" title="gS"><script>const prefDark = window.matchMedia('(prefers-color-scheme: dark)');
      document
        .querySelector('meta[name="theme-color"]')
        .setAttribute('content', prefDark ? '#111827' : '#F9FAFB');
      document
        .querySelector('meta[name="msapplication-TileColor"]')
        .setAttribute('content', prefDark ? '#111827' : '#F9FAFB');</script></head><body><main class="w-full mx-auto flex flex-grow flex-col post-content"><header class="flex flex-col my-5 max-w-7xl mx-auto w-full px-5"><div class="flex justify-between items-center gap-5 flex-col sm:flex-row mb-4 lg:mb-11"><a class="block font-semibold text-3xl text-teal-600 dark:text-teal-500" href="/">gS</a><nav><div class="fade flex gap-4 flex-wrap items-start justify-start"><a class="underline" href="/posts/">Posts</a> <a class="underline" href="/tags/">Tags</a> <a class="underline" href="/contact/">Contact</a> <a class="underline" href="/uses/">Uses</a> <a class="underline" href="/feed/feed.xml">RSS</a></div></nav></div></header><section class="items-center mb-6 gap-5 max-w-6xl mx-auto px-5 w-full"><h1>Day 5 - Your first week in NodeJS</h1><div class="text-sm text-gray-600 my-5 flex flex-col lg:flex-row gap-3 dark:text-gray-200 border-b border-b-gray-600 dark:border-b-gray-200 pb-8"><date class="slash" datetime="2021-08-09">Aug 09, 2021</date><span class="slash">17 min read</span> <span class="slash"><span><span class="text-teal-600 dark:text-teal-400">#</span><a href="/tags/nodejs/">nodejs</a></span><span><span class="text-teal-600 dark:text-teal-400">#</span><a href="/tags/programming/">programming</a></span><span><span class="text-teal-600 dark:text-teal-400">#</span><a href="/tags/your-first-week-in-nodejs/">your-first-week-in-nodejs</a></span></span></div><picture><source type="image/jpeg" srcset="/assets/images/-P6JrhZdHp-learwithgurpreet-400w.jpeg 400w, /assets/images/-P6JrhZdHp-learwithgurpreet-640w.jpeg 640w" sizes="100vw"><source type="image/webp" srcset="/assets/images/-P6JrhZdHp-learwithgurpreet-400w.webp 400w, /assets/images/-P6JrhZdHp-learwithgurpreet-640w.webp 640w" sizes="100vw"><img alt="featured" loading="lazy" decoding="async" class="featured-image" src="/assets/images/-P6JrhZdHp-learwithgurpreet-400w.jpeg" width="640" height="336"></picture><p class="text-center text-sm text-gray-600 dark:text-gray-200"></p><h2>What's Inside</h2><aside class="my-8 toc-container"><nav class="toc"><ol><li><a href="#prerequisite">Prerequisite</a></li><li><a href="#quick-recap">Quick recap</a></li><li><a href="#what-is-nosql">What is NoSQL?</a></li><li><a href="#mongodb-integration">MongoDB Integration</a></li><li><a href="#mongodb-integration-1">MongoDB Integration</a></li><li><a href="#useful-links">Useful Links</a></li></ol></nav></aside><article><p>As promised, this is my fifth article of <a href="/category/your-first-week-in-nodejs/">Your first week in NodeJS</a> web article series.</p><h2 id="prerequisite" tabindex="-1"><a class="direct-link" href="#prerequisite"><span>Prerequisite</span></a></h2><ol><li><a href="/posts/day-1-your-first-week-in-nodejs">Day 1 - Your first week in NodeJS</a></li><li><a href="/posts/day-2-your-first-week-in-nodejs">Day 2 - Your first week in NodeJS</a></li><li><a href="/posts/day-3-your-first-week-in-nodejs">Day 3 - Your first week in NodeJS</a></li><li><a href="/posts/day-4-your-first-week-in-nodejs">Day 4 - Your first week in NodeJS</a></li></ol><h2 id="quick-recap" tabindex="-1"><a class="direct-link" href="#quick-recap"><span>Quick recap</span></a></h2><p>In my previous article, I explained how to implement a template engine to get dynamic variables into your HTML file.</p><p>We used static data to show and save users in memory, now we will connect our application to MongoDB for better features and sustainability.</p><h2 id="what-is-nosql" tabindex="-1"><a class="direct-link" href="#what-is-nosql"><span>What is NoSQL?</span></a></h2><p>Big data changed how we used to think of databases and storage, we used to have relational databases like MYSQL, SQLServer, etc. but now we have another technique to store data called <a href="https://www.mongodb.com/nosql-explained">NoSQL</a>.</p><p>It stores data in documents in the form of JSON, instead of tables with rows and columns and it works very well with JavaScript (Node.js). This is what data looks like in the MongoDB database.</p><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"_id"</span><span class="token operator">:</span> <span class="token string">"610ec10c78f7665bfa2cbf11"</span><span class="token punctuation">,</span><br>    <span class="token property">"age"</span><span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span><br>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Bobbi Cannon"</span><span class="token punctuation">,</span><br>    <span class="token property">"email"</span><span class="token operator">:</span> <span class="token string">"bobbicannon@dragbot.com"</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">]</span></code></pre><p>When we are not sure about the data structure or what kind of data is expected we can blindly choose the NoSQL approach and the industry-leading option is to go with MongoDB.</p><h2 id="mongodb-integration" tabindex="-1"><a class="direct-link" href="#mongodb-integration"><span>MongoDB Integration</span></a></h2><p>We will be using <a href="https://account.mongodb.com/account/login">MongoLabs</a> for our MongoDB database setup which comes with the free tier option.</p><p>You can go to <a href="https://account.mongodb.com/account/login">https://account.mongodb.com/account/login</a> and claim your free account. You can follow the given steps to create a new database.</p><p><img src="/assets/images/SUhXqX_0a-1024x385.png" alt="create project" title="create-project" loading="lazy"></p><p><strong>Create a new project</strong></p><p><img src="/assets/images/wCpF9djRm-1024x517.png" alt="save project" title="save-project" loading="lazy"></p><p><strong>Save project with members (default is logged-in user)</strong></p><p><img src="/assets/images/GjWoGMegW-1024x455.png" alt="create database" title="create-db" loading="lazy"></p><p><strong>Create your first database</strong></p><p><img src="/assets/images/Es-Go-hMJ-1024x774.png" alt="select plan" title="select-plan" loading="lazy"></p><p><strong>Select free plan</strong></p><p>Once you create your cluster, it will take some time for the initial deployment.</p><p><img src="/assets/images/lm898S-_05-1024x831.png" alt="create a database user" title="create-db-user" loading="lazy"></p><p>Now you need to create a user for your database</p><h2 id="mongodb-integration-1" tabindex="-1"><a class="direct-link" href="#mongodb-integration-1"><span>MongoDB Integration</span></a></h2><p>Now your database is ready with username/password. Let's install the mongoose npm package on our local. <code>$ npm install mongoose</code></p><p>Note: To save your MongoDB details, you need to have a file with the name <code>.env</code>, which allows you to send these values in <code>process.env</code> or Node.js environment variables.</p><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">MONGO_HOST</span><span class="token operator">=</span>my_hostname<br><span class="token assign-left variable">MONGO_PASS</span><span class="token operator">=</span>my_password<br><span class="token assign-left variable">MONGO_USER</span><span class="token operator">=</span>my_username<br><span class="token assign-left variable">MONGO_DB</span><span class="token operator">=</span>my_db_name</code></pre><blockquote><p>You will get above information in MongoDB connect option like <code>mongodb+srv://my_username:my_password@my_hostname/my_db_name?retryWrites=true&amp;w=majority</code></p></blockquote><p>After creating the <code>.env</code> file you need to install a couple of packages, please refer to the <code>package.json</code> file below:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"node"</span><span class="token punctuation">,</span><br>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span><br>  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><br>  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"app.js"</span><span class="token punctuation">,</span><br>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"nodemon app.js"</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><br>  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span><br>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"body-parser"</span><span class="token operator">:</span> <span class="token string">"^1.19.0"</span><span class="token punctuation">,</span><br>    <span class="token property">"dotenv"</span><span class="token operator">:</span> <span class="token string">"^10.0.0"</span><span class="token punctuation">,</span><br>    <span class="token property">"ejs"</span><span class="token operator">:</span> <span class="token string">"^3.1.6"</span><span class="token punctuation">,</span><br>    <span class="token property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.17.1"</span><span class="token punctuation">,</span><br>    <span class="token property">"mongoose"</span><span class="token operator">:</span> <span class="token string">"^5.13.5"</span><span class="token punctuation">,</span><br>    <span class="token property">"nodemon"</span><span class="token operator">:</span> <span class="token string">"^2.0.12"</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Now we are ready to change our <code>app.js</code> file with MongoDB changes.</p><p>First, you need to require the <code>dotenv</code> package to get MongoDB credentials from <code>.env</code> or <code>process.env</code>.</p><pre class="language-bash"><code class="language-bash">require<span class="token punctuation">(</span><span class="token string">"dotenv"</span><span class="token punctuation">)</span>.config<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>After requiring the package you will get access to all environment variables like this: <code>const { MONGO_USER, MONGO_HOST, MONGO_PASS, MONGO_DB } = process.env;</code></p><p>Now we will connect the application with MongoDB, it requires the below steps:</p><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"dotenv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mongoose"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// connect to the database</span><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">connectDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">MONGO_USER</span><span class="token punctuation">,</span> <span class="token constant">MONGO_HOST</span><span class="token punctuation">,</span> <span class="token constant">MONGO_PASS</span><span class="token punctuation">,</span> <span class="token constant">MONGO_DB</span> <span class="token punctuation">}</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">;</span><br>  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><br>    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_USER</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_PASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_HOST</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_DB</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token literal-property property">useNewUrlParser</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useUnifiedTopology</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useFindAndModify</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useCreateIndex</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">connectDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>We need to require the <code>mongoose</code> package, and then followed by <code>mongoose.connect()</code> we will connect our current to our MongoDB instance.</p><blockquote><p>It’s an async operation, you can use promise or async/await functions.</p></blockquote><p>Once you are done with the connection, we will define our <code>Schema</code> and <code>Modal</code>.</p><p><strong><code>Schema</code> is required to let MongoDB know what kind of collections you are going to store into documents.</strong></p><pre class="language-js"><code class="language-js"><span class="token comment">// Create Schema for users</span><br><span class="token keyword">const</span> usersSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">age</span><span class="token operator">:</span> Number<span class="token punctuation">,</span><br>  <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>  <span class="token literal-property property">email</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create Modal for users</span><br><span class="token keyword">const</span> UsersModal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>model</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">,</span> usersSchema<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>As I explained in my <a href="https://learnwithgurpreet.com/day-4-your-first-week-in-nodejs">previous article</a>, <code>_id</code> will be autogenerated by MongoDB.</p></blockquote><p>Please refer to the following updated <code>app.js</code> file (reset of the project setup will remain the same):</p><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"dotenv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mongoose"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// connect to the database</span><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">connectDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">MONGO_USER</span><span class="token punctuation">,</span> <span class="token constant">MONGO_HOST</span><span class="token punctuation">,</span> <span class="token constant">MONGO_PASS</span><span class="token punctuation">,</span> <span class="token constant">MONGO_DB</span> <span class="token punctuation">}</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">;</span><br>  <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><br>    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongodb+srv://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_USER</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_PASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_HOST</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MONGO_DB</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token literal-property property">useNewUrlParser</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useUnifiedTopology</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useFindAndModify</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">useCreateIndex</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">connectDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create Schema for users</span><br><span class="token keyword">const</span> usersSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">age</span><span class="token operator">:</span> Number<span class="token punctuation">,</span><br>  <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>  <span class="token literal-property property">email</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create Modal for users</span><br><span class="token keyword">const</span> UsersModal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>model</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">,</span> usersSchema<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"view engine"</span><span class="token punctuation">,</span> <span class="token string">"ejs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"*"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Methods"</span><span class="token punctuation">,</span> <span class="token string">"GET,PUT,POST,DELETE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"text/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// parse application/x-www-form-urlencoded</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/assets"</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">"assets"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">getUserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token constant">USER_DATA</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>_id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// Get list of users, and set data</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  UsersModal<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> docs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">data</span><span class="token operator">:</span> docs<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Get single user by id, and set data</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/user/:id"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  UsersModal<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">data</span><span class="token operator">:</span> doc<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Loading view of contact page</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/contact"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/contact.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// RESTFul API Services</span><br><br><span class="token comment">// get all users</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/api/users"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  UsersModal<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> docs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// get single user by id</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/api/user/:id"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  UsersModal<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// delete single user by id</span><br>app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"/api/user/:id"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  UsersModal<span class="token punctuation">.</span><span class="token function">findOneAndDelete</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// update single user by id</span><br>app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/api/user/:id"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    UsersModal<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><br>      <span class="token punctuation">{</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"id is missing in params"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// add new user</span><br>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/api/user"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">&amp;&amp;</span> age <span class="token operator">&amp;&amp;</span> email<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    UsersModal<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><br>      <span class="token punctuation">{</span><br>        age<span class="token punctuation">,</span><br>        name<span class="token punctuation">,</span><br>        email<span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"error, user not added."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="useful-links" tabindex="-1"><a class="direct-link" href="#useful-links"><span>Useful Links</span></a></h2><ul><li><a href="https://account.mongodb.com/account/login">MongoDB</a></li><li><a href="https://www.npmjs.com/package/mongoose">npm-mongoose</a></li><li><a href="https://mongoosejs.com/docs/">Mongoose Docs</a></li><li><a href="https://www.npmjs.com/package/dotenv">npm-dotenv</a></li></ul></article><a target="_blank" class="text-teal-700 dark:text-teal-400 mt-4 inline-block" rel="noopener noreferrer" href="https://github.com/learnwithgurpreet/learnwithgurpreet/blob/main/src/posts/day-5-your-first-week-in-nodejs.md">Edit post</a></section><section class="gap-1 p-1 my-5 lg:my-8 flex flex-col lg:flex-row justify-center lg:justify-between mx-5"><a class="flex-col items-start justify-center no-decoration" href="/posts/day-4-your-first-week-in-nodejs/"><span class="text-sm uppercase">← Previous</span><h3>Day 4 - Your first week in NodeJS</h3></a><a class="flex-col items-end justify-center text-right no-decoration" href="/posts/day-6-your-first-week-in-nodejs/"><span class="text-sm uppercase">Next →</span><h3>Day 6 (last) - Your first week in NodeJS</h3></a></section></main><footer class="w-full bg-gray-700 border-t-4 border-teal-600 text-gray-50 flex justify-between text-sm p-4"><span class="italic flex-grow">©2023 Gurpreet Singh</span><nav class="flex gap-2"><a rel="me" class="text-gray-50 underline" href="https://mastodon.social/@gsin" title="Link to my Mastodon page">mastodon</a> <a rel="me" class="text-gray-50 underline" href="https://github.com/learnwithgurpreet" title="Link to my Github page">github</a> <a rel="me" class="text-gray-50 underline" href="/feed/feed.xml" title="Link to my RSS feed">RSS</a></nav></footer></body></html>
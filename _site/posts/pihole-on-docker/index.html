<!doctype html><html lang="en"><head><meta charset="utf-8"><link rel="shortcut icon" href="/assets/favicons/favicon.ico"><link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/assets/favicons/android-chrome-192x192.png" sizes="192x192"><link rel="icon" type="image/png" href="/assets/favicons/android-chrome-512x512.png" sizes="512x512"><link rel="apple-touch-icon" href="/assets/favicons/apple-touch-icon.png"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="color-scheme" content="light dark"><meta name="msapplication-TileColor" content="#F9FAFB"><meta name="theme-color" content="#F9FAFB"><title>Learn with Gurpreet - PiHole on Docker</title><meta name="keywords" content="CSS, front-end, web design, consulting, architecture"><meta name="description" content="This article is my follow-up article to Up and running with RaspberryPi with Docker. In the previous article, I showed how you can configure docker and docker-compose on your RaspberryPi."><meta name="og:image" content="https://learnwithgurpreet.com/assets/images/docker-rpi-e1643359911626.webp"><meta name="og:title" content="Learn with Gurpreet - PiHole on Docker"><meta name="og:description" content="This article is my follow-up article to Up and running with RaspberryPi with Docker. In the previous article, I showed how you can configure docker and docker-compose on your RaspberryPi."><meta name="og:url" content="https://learnwithgurpreet.com/posts/pihole-on-docker/"><meta name="og:site_name" content="Learn with Gurpreet"><meta name="og:locale" content="en_GB"><meta name="og:type" content="article"><meta name="twitter:title" content="Learn with Gurpreet - PiHole on Docker"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="This article is my follow-up article to Up and running with RaspberryPi with Docker. In the previous article, I showed how you can configure docker and docker-compose on your RaspberryPi."><meta name="twitter:image" content="https://learnwithgurpreet.com/assets/images/docker-rpi-e1643359911626.webp"><meta name="generator" content="Eleventy v2.0.1"><meta itemprop="name" content="Learn with Gurpreet - PiHole on Docker"><meta itemprop="description" content="This article is my follow-up article to Up and running with RaspberryPi with Docker. In the previous article, I showed how you can configure docker and docker-compose on your RaspberryPi."><link rel="stylesheet" href="/assets/css/styles.css?v=1681830158621"><link rel="alternate" href="https://learnwithgurpreet.com/feed/feed.xml" type="application/atom+xml" title="gS"><link rel="alternate" href="https://learnwithgurpreet.com/feed/feed.json" type="application/json" title="gS"><script>const prefDark = window.matchMedia('(prefers-color-scheme: dark)');
      document
        .querySelector('meta[name="theme-color"]')
        .setAttribute('content', prefDark ? '#111827' : '#F9FAFB');
      document
        .querySelector('meta[name="msapplication-TileColor"]')
        .setAttribute('content', prefDark ? '#111827' : '#F9FAFB');</script></head><body><main class="w-full mx-auto flex flex-grow flex-col post-content"><header class="flex flex-col my-5 max-w-7xl mx-auto w-full px-5"><div class="flex justify-between items-center gap-5 flex-col sm:flex-row mb-4 lg:mb-11"><a class="block font-semibold text-3xl text-teal-600 dark:text-teal-500" href="/">gS</a><nav><div class="fade flex gap-4 flex-wrap items-start justify-start"><a class="underline" href="/posts/">Posts</a> <a class="underline" href="/tags/">Tags</a> <a class="underline" href="/contact/">Contact</a> <a class="underline" href="/uses/">Uses</a> <a class="underline" href="/feed/feed.xml">RSS</a></div></nav></div></header><section class="items-center mb-6 gap-5 max-w-6xl mx-auto px-5 w-full"><h1>PiHole on Docker</h1><div class="text-sm text-gray-600 my-5 flex flex-col lg:flex-row gap-3 dark:text-gray-200 border-b border-b-gray-600 dark:border-b-gray-200 pb-8"><date class="slash" datetime="2021-05-21">May 21, 2021</date><span class="slash">3 min read</span> <span class="slash"><span><span class="text-teal-600 dark:text-teal-400">#</span><a href="/tags/programming/">programming</a></span><span><span class="text-teal-600 dark:text-teal-400">#</span><a href="/tags/raspberry-pi/">raspberry-pi</a></span></span></div><picture><source type="image/jpeg" srcset="/assets/images/ZAzG6sKrGU-learwithgurpreet-400w.jpeg 400w, /assets/images/ZAzG6sKrGU-learwithgurpreet-640w.jpeg 640w" sizes="100vw"><source type="image/webp" srcset="/assets/images/ZAzG6sKrGU-learwithgurpreet-400w.webp 400w, /assets/images/ZAzG6sKrGU-learwithgurpreet-640w.webp 640w" sizes="100vw"><img alt="featured" loading="lazy" decoding="async" class="featured-image" src="/assets/images/ZAzG6sKrGU-learwithgurpreet-400w.jpeg" width="640" height="336"></picture><p class="text-center text-sm text-gray-600 dark:text-gray-200"></p><h2>What's Inside</h2><aside class="my-8 toc-container"><nav class="toc"><ol><li><a href="#installation">Installation</a></li><li><a href="#configure-devices">Configure devices</a></li></ol></nav></aside><article><p>This article is my follow-up article to <a href="/posts/up-and-running-with-raspberrypi-with-docker/">Up and running with RaspberryPi with Docker</a>. In the previous article, I showed how you can configure docker and docker-compose on your RaspberryPi.</p><p>Let's check how to restrict external traffic from your RaspberryPi with <a href="https://hub.docker.com/r/pihole/pihole">PiHole</a> using docker and docker-compose.</p><h2 id="installation" tabindex="-1"><a class="direct-link" href="#installation"><span>Installation</span></a></h2><p>The first step to defining a place where you want to install PiHole. In my case, I am going to keep it under the <code>~</code> path.</p><pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> ~<br>$ <span class="token function">mkdir</span> pihole<br>$ <span class="token builtin class-name">cd</span> pihole<br>$ <span class="token function">touch</span> docker-compose.yml</code></pre><p>Once you create the <em>docker-compose.yml</em> file inside the <em>pihole</em> directory, add the following code into it.</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">nano</span> docker-compose.yml</code></pre><pre class="language-yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3"</span><br><br><span class="token key atrule">services</span><span class="token punctuation">:</span><br>  <span class="token key atrule">pihole</span><span class="token punctuation">:</span><br>    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> pihole<br>    <span class="token key atrule">image</span><span class="token punctuation">:</span> pihole/pihole<span class="token punctuation">:</span>latest<br>    <span class="token key atrule">ports</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"53:53/tcp"</span><br>      <span class="token punctuation">-</span> <span class="token string">"53:53/udp"</span><br>      <span class="token punctuation">-</span> <span class="token string">"67:67/udp"</span><br>      <span class="token punctuation">-</span> <span class="token string">"80:80/tcp"</span><br>    <span class="token key atrule">environment</span><span class="token punctuation">:</span><br>      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> <span class="token string">"America/Chicago"</span><br>      <span class="token key atrule">WEBPASSWORD</span><span class="token punctuation">:</span> <span class="token string">"strongPassword"</span><br>    <span class="token key atrule">volumes</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> <span class="token string">"./etc-pihole/:/etc/pihole/"</span><br>      <span class="token punctuation">-</span> <span class="token string">"./etc-dnsmasq.d/:/etc/dnsmasq.d/"</span><br>    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span><br>      <span class="token punctuation">-</span> NET_ADMIN<br>    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped</code></pre><p>After saving the <em>docker-compose.yml</em> file, you can run the following command to bring your PiHole server up and running.</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker-compose</span> up --detach</code></pre><blockquote><p>Initial run will take some time since it will download the PiHole image from docker.</p></blockquote><p>After a successful run, you can check PiHole instance is running on RaspberryPi as a docker service.</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># Try following commands to check PiHole service</span><br><br>$ <span class="token function">docker</span> <span class="token function">ps</span><br><span class="token comment"># To check the list of running containers</span><br><br>$ <span class="token function">docker</span> images<br><span class="token comment"># To check PiHole image</span></code></pre><p>If you have static IP defined <a href="https://learnwithgurpreet.com/posts/up-and-running-with-raspberrypi-with-docker/">configured in my previous article</a> then you can access PiHole, at <a href="http://192.168.0.4/admin">http://192.168.0.4/admin</a></p><h2 id="configure-devices" tabindex="-1"><a class="direct-link" href="#configure-devices"><span>Configure devices</span></a></h2><p>After the installation of PiHole now we need to map other devices to use PiHole as the default gateway. For that, you can go to the network/Wifi settings of your individual devices and add <strong>192.168.0.4</strong> IP address to the DNS list (should be on top). See the example below:</p><p><img src="/assets/images/Ijzg5OW20.png" alt="network setup" title="network_setup.png" loading="lazy"></p><p>DNS settings on MAC</p><p>Thanks for following the tutorial, happy coding!</p></article><a target="_blank" class="text-teal-700 dark:text-teal-400 mt-4 inline-block" rel="noopener noreferrer" href="https://github.com/learnwithgurpreet/learnwithgurpreet/blob/main/src/posts/pihole-on-docker.md">Edit post</a></section><section class="gap-1 p-1 my-5 lg:my-8 flex flex-col lg:flex-row justify-center lg:justify-between mx-5"><a class="flex-col items-start justify-center no-decoration" href="/posts/up-and-running-with-raspberrypi-with-docker/"><span class="text-sm uppercase">← Previous</span><h3>Up and running with RaspberryPi with Docker</h3></a><a class="flex-col items-end justify-center text-right no-decoration" href="/posts/github-copilot-future-of-programming/"><span class="text-sm uppercase">Next →</span><h3>GitHub Copilot - Future of Programming?</h3></a></section></main><footer class="w-full bg-gray-700 border-t-4 border-teal-600 text-gray-50 flex justify-between text-sm p-4"><span class="italic flex-grow">©2023 Gurpreet Singh</span><nav class="flex gap-2"><a rel="me" class="text-gray-50 underline" href="https://mastodon.social/@gsin" title="Link to my Mastodon page">mastodon</a> <a rel="me" class="text-gray-50 underline" href="https://github.com/learnwithgurpreet" title="Link to my Github page">github</a> <a rel="me" class="text-gray-50 underline" href="/feed/feed.xml" title="Link to my RSS feed">RSS</a></nav></footer></body></html>